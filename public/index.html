<!DOCTYPE html>
<html>
	<head>
		<title>combine fullcalender,socket</title>
		<meta charset="utf-8">
		<script src="socket.io/socket.io.js"></script>
		<link rel="stylesheet" href="style.css" />

		<!Fullcalender includes>
		<link rel='stylesheet' href='fullcalendar.css' />
		<script src='lib/jquery-3.1.1.js'></script>
		<script src='lib/moment.min.js'></script>
		<script src='lib/moment-timezone.js'></script>
		<script src='fullcalendar.js'></script>
		<!Fullcalender includes end>
	
			<!bootstrap from example>
			<script src='lib/bootstrap.min.js'></script>
			<link rel="stylesheet" href="lib/bootstrap-combined.min.css" >
		<!jQueryUI>
		<script src="lib/jquery-ui.js"></script>
		<link rel="stylesheet" href="lib/jquery-ui.css">
		<!jquery.timepicker>
		<script src="lib/jquery.timepicker.js"></script>
		<link rel="stylesheet" href="lib/jquery.timepicker.css">
		<script src="client.js"></script>
	</head>


 
	<body>
	<h1 style="letter-spacing:4px; font-family:Fantasy; text-align:right;
color:#800000; border-bottom:double #FFFF00; width="100%"; font-size:24pt">
	Combine fullcalender and socket.io.</h1>
	

		<img src="/pictures/Tulpen.jpg" 
		alt="Kalenderkopf"
		width="100%" height ="100%">


			<input id="name" type="text" placeholder="Eventname" />
			<input id="text" type="text" placeholder="schreibe etwas..." />
			<input id="senden" type="submit" class="btn" value="senden" />
		

		<ul id="content"></ul>
		<div id='calendar'></div>
		<! Test MODÀL mit Button>
		<div class "container">
			<div class="row">
				<div class="col-md-3">

					<button type= "button" class="btn btn-primary" data-toggle="modal" data-target="#mymodal">
						Create Event
					</button>

					<div class="modal fade" id="mymodal">
						<div class="modal-content">
							<div class="modal-header">
								<h3>Neuer Termin:</h3>
							</div>
							<div class="modal-body">
								
							</div>
							<div class="modal-footer">
								<button type="button" class "btn btn-primary" data-dismiss="modal">x</button>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>	

	<!http://jsfiddle.net/mccannf/AzmJv/16/  includ modal for eventcreation>
		<div id="createEventModal" class="modal fade" tabindex="-1" role="dialog">
		    <div class="modal-header">
		        <button type="button" class="btn btn-primary" data-dismiss="modal">x</button>
		        <h4 id="myModalLabel1" class="modal-title">Create Appointment</h4>
		    </div>
		    <div class="modal-body">
		    <form id="createAppointmentForm" class="form-horizontal">
		        <div class="control-group">
		            <label class="control-label" for="inputEvent">Event Name:</label>
		            <div class="controls">
		                <input type="text" name="eventName" id="eventName" tyle="margin: 0 auto;" data-provide="typeahead" data-items="4" data-source="[&quot;Value 1&quot;,&quot;Value 2&quot;,&quot;Value 3&quot;]">
		                <p>Beginn: <input type="text" id="datepickerStart"></p>
		                	<p>Startzeit: <input type="text" id="timepickerStart"></p>
		                   <p>Ende: <input type="text" id="datepickerEnd"></p>	
							<p>Endzeit: <input type="text" id="timepickerEnd"></p>
		                  <input type="text" id="apptStartTime"/>
		                  <input type="hidden" id="apptEndTime"/>
		                  <input type="hidden" id="apptAllDay" />
		            </div>
		        </div>
		        <div class="control-group">
		            <label class="control-label" for="when">When:</label>
		            <div class="controls controls-row" id="when" style="margin-top:5px;">
		            </div>
		        </div>
		    </form>
		    </div>
		    <div class="modal-footer">
		        <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
		        <button type="submit" class="btn btn-primary" id="submitButton">Save</button>
		    </div>
		</div>

	



		<script>
		$(document).ready(function() {
 //<script>
  //$( function() {
  
  //} );
  //<//script>
  
		//Add local german Timezone to moment.tz 
  		moment.tz.add('Europe/Berlin|CET CEST CEMT|-10 -20 -30|01010101010101210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 kL0 Nc0 m10 WM0 1ao0 1cp0 dX0 jz0 Dd0 1io0 17c0 1fA0 1a00 1ehA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|41e5');

//Datepicker
  /*
  		     Datepair('#jqueryExample.date').datepicker({
					        'format': 'm/d/yyyy',
					        'autoclose': true
					    });
   			Datepair('#jqueryExample').datepair();
*/
  			var date = new Date();
			var d = date.getDate();
			var m = date.getMonth();
			var y = date.getFullYear();

	     	var calendar = $('#calendar').fullCalendar({
	     	 //header and other values

	     		header: {
					left: 'prev,next today',
					center: 'title',
					right: 'month,agendaWeek,agendaDay,listMonth'
				},
				/*
				 views: {
				        month: {
				        	 timeFormat: 'HH(:mm)'
				            // options apply to basicWeek and basicDay views
				        },
				        agendaWeek: {
				        	 timeFormat: 'HH(:mm)',
				        	
				            // options apply to agendaWeek and agendaDay views
				        },
				        agendaDay: {
				        	 timeFormat: 'HH(:mm)'
				            // options apply to basicWeek and agendaWeek views
				        },
				        listMonth: {
				        	 timeFormat: 'HH(:mm)'
				            // options apply to basicDay and agendaDay views
				        }
				  },
				  */
				 //Add local german Timezone 
		      	timezone: ('local'),
		      	defaultView: 'month',
		     	editable: true,
		        selectable: true,
				navLinks: true, // can click day/week names to navigate views
				businessHours: true, // display business hours

				//firstday = 1 week will start on mondays
		 		firstDay: 1,
				//auf 24Stunden Uhr umstellen!
				TimeFormat: 'H(:mm)',

			 	select: function(start, end, allDay) {
			       		//start and end are moment (data)!
					
			          endtime = moment.tz(end, "Europe/Berlin").format('ddd, MMM do, H(:mm) ');
			          starttime = moment.tz(start, "Europe/Berlin").format('ddd, MMM do, H(:mm) ');
			  
			          var mywhen = starttime + ' - ' + endtime;
			          //nicht mehr nötig
			          var startDate =new Date($('#createEventModal #apptStartTime').val(start));

			          var endDate =$('#createEventModal #apptEndTime').val(end);
			            
			          $('#createEventModal #apptAllDay').val(allDay);
			          $('#createEventModal #when').text(mywhen);
			          // next init time/datePicker
			         //datepicker API http://api.jqueryui.com/
					    $( "#datepickerStart" ).datepicker({
					    	//start on Monday
					    	 firstDay: 1,
					    	 //Selected Date  in Format (Default= "mm/dd/yy")
					    	dateFormat:"dd-mm-yy",
					    });
					 
					  //after init setDate
					$( "#datepickerStart" ).datepicker("setDate", new Date(start.year(),start.month(),start.date()));

				    $( "#datepickerEnd" ).datepicker({
				    	//start on Monday
				    	 firstDay: 1,
				    	 //Selected Date  in Format (Default= "mm/dd/yy")
				    	dateFormat:"dd-mm-yy",
				    });
					  
					$( "#datepickerEnd" ).datepicker("setDate", new Date(end.year(),end.month(),end.date()));

					//Time picker API https://github.com/jonthornton/jquery-timepicker
					$('#timepickerStart').timepicker({'timeFormat': 'H:i','step': 5, 'setTime': new Date(start.get('hour'),start.get('minute')) });


					$('#timepickerEnd').timepicker({ 'timeFormat': 'H:i','step': 5  });	
				
			          $('#createEventModal').modal('show');
			         
			     	},



				
		     		events: [
						{
							id: 'availableForMeeting',
							start: '2016-12-2T10:00:00',
							end: '2016-12-2T16:00:00',
							rendering: 'background'
						},

						// red areas where no events can be dropped
						{
							start: '2016-12-24',
							end: '2016-12-31',
							overlap: false,
							rendering: 'background',
							color: '#ff9f89'
						},
					
						{
							title: 'Meeting',
							start: '2016-11-30T13:30:00',
							color: '#d50000'
						},
						{
							id: 999,
							title: 'Fechten',
							start: '2016-11-30T17:00:00',
							end: '2016-11-30T19:00:00',
							color: '#4a148c'
						},
						{
							id: 999,
							title: 'Fechten',
							start: '2016-12-01T20:00:00',
							end: '2016-12-01T22:00:00',
							color: '#4a148c'
						},
						{
							title: 'Gospel singen',
							start: '2016-11-29T17:30:00',
							url: 'https://www.facebook.com/GOSPELFORUMStuttgart/?fref=ts',
							end: '2016-11-29T19:30:00',
							color: '#f4511e'
						}
						
					],
					
	    	   		 // put your options and callbacks here
	    		
			});
  
	
         

		  $('#submitButton').on('click', function(e){
		    // We don't want this to act as a link so cancel the link action
		    e.preventDefault();

		    doSubmit();
		  });

		  function doSubmit(){
		    $("#createEventModal").modal('hide');
		    console.log($('#apptStartTime').val());
		    console.log($('#apptEndTime').val());
		    console.log($('#apptAllDay').val());
		   // alert("form submitted");
		        
		    $("#calendar").fullCalendar('renderEvent',
		        {
		            title: $('#eventName').val(),
		            start: new Date($('#apptStartTime').val()),
		            end: new Date($('#apptEndTime').val()),
		            allDay: ($('#apptAllDay').val() == "true"),
		        },
		        true);
		        console.log($('#apptEndTime').val());
		   }
		    		
		});
				
			
		</script>




		<style>
	body {
		margin: 40px 10px;
		padding: 0;
		font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
		font-size: 14px;
	}
	//calendar size
	#calendar {
		max-height: $(window).height()*0.7;
		//max-width:  $(window).width();
		margin: 0 auto;
	}


	</body>
</html>